"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4253],{25127:(n,a,s)=>{s.r(a),s.d(a,{data:()=>e});const e={key:"v-71cac2c5",path:"/6.x/open-work/oauth.html",title:"OAuth",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"è·å– OAuth æ¨¡å—å®ä¾‹",slug:"è·å–-oauth-æ¨¡å—å®ä¾‹",children:[]},{level:2,title:"è·³è½¬æˆæƒ",slug:"è·³è½¬æˆæƒ",children:[]},{level:2,title:"è·å–æˆæƒç”¨æˆ·ä¿¡æ¯",slug:"è·å–æˆæƒç”¨æˆ·ä¿¡æ¯",children:[]},{level:2,title:"å‚è€ƒé˜…è¯»",slug:"å‚è€ƒé˜…è¯»",children:[]}],filePathRelative:"6.x/open-work/oauth.md",git:{updatedTime:1629906046e3,contributors:[]}}},33989:(n,a,s)=>{s.r(a),s.d(a,{default:()=>$});var e=s(66252);const p=(0,e._)("h1",{id:"oauth",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#oauth","aria-hidden":"true"},"#"),(0,e.Uk)(" OAuth")],-1),t=(0,e._)("p",null,"ç¬¬ä¸‰æ–¹æœåŠ¡å•†ç½‘é¡µæˆæƒæœ‰ä¸¤ç§ï¼š",-1),o={href:"https://open.work.weixin.qq.com/api/doc/90001/90143/91120#%E6%9E%84%E9%80%A0%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%94%E7%94%A8oauth2%E9%93%BE%E6%8E%A5",target:"_blank",rel:"noopener noreferrer"},l=(0,e.Uk)("ç¬¬ä¸‰æ–¹åº”ç”¨ç½‘é¡µæˆæƒ"),c={href:"https://open.work.weixin.qq.com/api/doc/90001/90143/91120#%E6%9E%84%E9%80%A0%E4%BC%81%E4%B8%9Aoauth2%E9%93%BE%E6%8E%A5",target:"_blank",rel:"noopener noreferrer"},r=(0,e.Uk)("ä¼ä¸šç½‘é¡µæˆæƒ"),i=(0,e.uE)('<p>åˆ›å»ºå®ä¾‹ï¼š</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">EasyWeChat<span class="token punctuation">\\</span>work<span class="token punctuation">\\</span>Application</span><span class="token punctuation">;</span>\n\n<span class="token variable">$config</span> <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token string single-quoted-string">&#39;corp_id&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;xxxxxxxxxxxxxxxxx&#39;</span><span class="token punctuation">,</span>\n    <span class="token string single-quoted-string">&#39;secret&#39;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;xxxxxxxxxx&#39;</span><span class="token punctuation">,</span> <span class="token comment">// åº”ç”¨çš„ secret</span>\n<span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n<span class="token variable">$app</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token variable">$config</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="è·å–-oauth-æ¨¡å—å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#è·å–-oauth-æ¨¡å—å®ä¾‹" aria-hidden="true">#</a> è·å– OAuth æ¨¡å—å®ä¾‹</h2><p>è¯·æ ¹æ®ä½ çš„åœºæ™¯é€‰æ‹©å¯¹åº”çš„æ–¹æ³•è·å– OAuth å®ä¾‹ï¼š</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment"># ç¬¬ä¸‰æ–¹åº”ç”¨ç½‘é¡µæˆæƒ</span>\n<span class="token variable">$oauth</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">getOAuth</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$suiteId</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">AccessTokenInterface</span> <span class="token variable">$suiteAccessToken</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment"># ä¼ä¸šç½‘é¡µæˆæƒ</span>\n<span class="token variable">$oauth</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">getCorpOAuth</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$corpId</span><span class="token punctuation">,</span> <span class="token keyword type-hint">int</span> <span class="token variable">$agentId</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">AccessTokenInterface</span> <span class="token variable">$suiteAccessToken</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="è·³è½¬æˆæƒ" tabindex="-1"><a class="header-anchor" href="#è·³è½¬æˆæƒ" aria-hidden="true">#</a> è·³è½¬æˆæƒ</h2><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// $callbackUrl ä¸ºæˆæƒå›è°ƒåœ°å€</span>\n<span class="token variable">$callbackUrl</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;https://xxx.xxx&#39;</span><span class="token punctuation">;</span> <span class="token comment">// éœ€è®¾ç½®å¯ä¿¡åŸŸå</span>\n\n<span class="token comment">// è¿”å›æˆæƒè·³è½¬é“¾æ¥</span>\n<span class="token variable">$redirectUrl</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">getOAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token variable">$callbackUrl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="è·å–æˆæƒç”¨æˆ·ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#è·å–æˆæƒç”¨æˆ·ä¿¡æ¯" aria-hidden="true">#</a> è·å–æˆæƒç”¨æˆ·ä¿¡æ¯</h2><p>åœ¨å›è°ƒé¡µé¢ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è·å–æˆæƒè€…ä¿¡æ¯ï¼š</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;å›è°ƒURLä¸­çš„code&quot;</span><span class="token punctuation">;</span>\n<span class="token variable">$user</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token operator">-&gt;</span><span class="token function">getOAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">detailed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">userFromCode</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// è·å–ç”¨æˆ·ä¿¡æ¯</span>\n<span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯¹åº”ä¼ä¸šå¾®ä¿¡è‹±æ–‡åï¼ˆuseridï¼‰</span>\n<span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">getRaw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–ä¼ä¸šå¾®ä¿¡æ¥å£è¿”å›çš„åŸå§‹ä¿¡æ¯</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div>',10),u=(0,e.Uk)("ğŸ“– OAuth è¯¦æƒ…è¯·å‚è€ƒï¼š"),k=(0,e.Uk)("ç½‘é¡µæˆæƒ"),b=(0,e.Uk)("è·å–ç”¨æˆ·å…¶ä»–ä¿¡æ¯éœ€è°ƒç”¨é€šè®¯å½•æ¥å£ï¼Œå‚è€ƒï¼š"),d={href:"https://github.com/EasyWeChat/docs/blob/master/wework/contacts.md",target:"_blank",rel:"noopener noreferrer"},h=(0,e.Uk)("ä¼ä¸šå¾®ä¿¡é€šè®¯å½•API"),m=(0,e._)("h2",{id:"å‚è€ƒé˜…è¯»",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#å‚è€ƒé˜…è¯»","aria-hidden":"true"},"#"),(0,e.Uk)(" å‚è€ƒé˜…è¯»")],-1),g=(0,e.Uk)("æœ¬æ¨¡å—åŸºäº "),v={href:"https://github.com/overtrue/socialite/",target:"_blank",rel:"noopener noreferrer"},x=(0,e.Uk)("overtrue/socialite"),f=(0,e.Uk)(" å®ç°ï¼Œæ›´å¤šçš„ä½¿ç”¨è¯·é˜…è¯»è¯¥æ‰©å±•åŒ…æ–‡æ¡£ã€‚"),A=(0,e.Uk)("state å‚æ•°çš„ä½¿ç”¨: "),_={href:"https://github.com/overtrue/socialite/#state",target:"_blank",rel:"noopener noreferrer"},E=(0,e.Uk)("overtrue/socialite/#state"),$={render:function(n,a){const s=(0,e.up)("OutboundLink"),$=(0,e.up)("RouterLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[p,t,(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("a",o,[l,(0,e.Wm)(s)])]),(0,e._)("li",null,[(0,e._)("a",c,[r,(0,e.Wm)(s)])])]),i,(0,e._)("p",null,[u,(0,e.Wm)($,{to:"/6.x/common/oauth.html"},{default:(0,e.w5)((()=>[k])),_:1})]),(0,e._)("p",null,[b,(0,e._)("a",d,[h,(0,e.Wm)(s)])]),m,(0,e._)("ul",null,[(0,e._)("li",null,[g,(0,e._)("a",v,[x,(0,e.Wm)(s)]),f]),(0,e._)("li",null,[A,(0,e._)("a",_,[E,(0,e.Wm)(s)])])])],64)}}}}]);
//# sourceMappingURL=v-71cac2c5.d6e817d6.js.map